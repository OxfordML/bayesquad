
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>bayesquad.optimisation module &#8212; Batch Bayesian quadrature  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Batch Bayesian quadrature  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-bayesquad.optimisation">
<span id="bayesquad-optimisation-module"></span><h1>bayesquad.optimisation module<a class="headerlink" href="#module-bayesquad.optimisation" title="Permalink to this headline">¶</a></h1>
<p>Utility functions wrapping a scipy optimizer.</p>
<dl class="function">
<dt id="bayesquad.optimisation.multi_start_maximise">
<code class="descclassname">bayesquad.optimisation.</code><code class="descname">multi_start_maximise</code><span class="sig-paren">(</span><em>objective_function: Callable, initial_points: List[numpy.ndarray], **kwargs</em><span class="sig-paren">)</span> &#x2192; Tuple[numpy.ndarray, float]<a class="reference internal" href="_modules/bayesquad/optimisation.html#multi_start_maximise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesquad.optimisation.multi_start_maximise" title="Permalink to this definition">¶</a></dt>
<dd><p>Run multi-start maximisation of the given objective function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>objective_function</strong> – Function to be maximised. Must return both the function value and the jacobian. Must also accept a 2D array of
points, returning a 1D array and a 2D array for the function values and jacobians respectively.</li>
<li><strong>initial_points</strong> – A list of arrays, each of shape (num_dimensions).</li>
<li><strong>**kwargs</strong> – Keyword arguments will be included in the ‘options’ dict passed to the underlying scipy optimiser.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>ndarray</em> – The location of the found maximum.</li>
<li><em>float</em> – The value of the objective function at the found maximum.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bayesquad.optimisation.multi_start_maximise_experimental">
<code class="descclassname">bayesquad.optimisation.</code><code class="descname">multi_start_maximise_experimental</code><span class="sig-paren">(</span><em>objective_function: Callable, initial_points: List[numpy.ndarray], **kwargs</em><span class="sig-paren">)</span> &#x2192; Tuple[numpy.ndarray, float]<a class="reference internal" href="_modules/bayesquad/optimisation.html#multi_start_maximise_experimental"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesquad.optimisation.multi_start_maximise_experimental" title="Permalink to this definition">¶</a></dt>
<dd><p>Run multi-start maximisation of the given objective function.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This is a hack to take advantage of fast vectorised computation and avoid expensive python loops. There are some
issues with this method!</p>
<p class="last">The objective function provided here must be a vectorised function. We take advantage of the fast computation of
vectorised functions to view a multi-start optimisation as a single pass of a higher-dimensional optimisation,
rather than several passes of a low-dimensional optimisation (which would require an expensive python loop). We
simply concatenate all the points where the function is to be evaluated into a single high-dimensional vector, give
the function value as the sum of all the individual function values, and give the jacobian as the concatenation of
all the individual jacobians. In this way we can essentially perform many optimisations in parallel. Note that
(among other issues) there is an issue here with the stopping condition: we can only consider all optimisations
together, so even if most have come very close to an optimum, the process will continue as long as one is far away.
However, this hack does seem to perform well in practice.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>objective_function</strong> – Function to be maximised. Must return both the function value and the jacobian. Must also accept a 2D array of
points, returning a 1D array and a 2D array for the function values and jacobians respectively.</li>
<li><strong>initial_points</strong> – A list of arrays, each of shape (num_dimensions).</li>
<li><strong>**kwargs</strong> – Keyword arguments will be included in the ‘options’ dict passed to the underlying scipy optimiser.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>ndarray</em> – The location of the found maximum.</li>
<li><em>float</em> – The value of the objective function at the found maximum.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bayesquad.optimisation.multi_start_maximise_log">
<code class="descclassname">bayesquad.optimisation.</code><code class="descname">multi_start_maximise_log</code><span class="sig-paren">(</span><em>objective_function: Callable, initial_points: List[numpy.ndarray], **kwargs</em><span class="sig-paren">)</span> &#x2192; Tuple[numpy.ndarray, float]<a class="reference internal" href="_modules/bayesquad/optimisation.html#multi_start_maximise_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesquad.optimisation.multi_start_maximise_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximise the given objective function in log space. This may be significantly easier for functions with a high
dynamic range.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#bayesquad.optimisation.multi_start_maximise_experimental" title="bayesquad.optimisation.multi_start_maximise_experimental"><code class="xref py py-func docutils literal notranslate"><span class="pre">multi_start_maximise_experimental()</span></code></a> : <cite>multi_start_maximise_log</cite> is a thin wrapper around this function. See
this function for further details on parameters and return values.</p>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/bayesquad.optimisation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Batch Bayesian quadrature  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Ed Wagstaff.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.8.
    </div>
  </body>
</html>